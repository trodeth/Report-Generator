<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIS Report Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6">KIS Report Generator</h1>
            
            <div class="space-y-4 mb-8">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        á€á¶á›á”ášá·á…áŸ’á†áŸá‘á…á¶á”áŸ‹á•áŸ’áá¾á˜ (Start Date)
                    </label>
                    <input
                        type="date"
                        id="startDate"
                        value="2026-01-15"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    />
                    <p class="text-sm text-gray-500 mt-1" id="startDatePreview">Will display as: 15-01-2026</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        á€á¶á›á”ášá·á…áŸ’á†áŸá‘á”á‰áŸ’á…á”áŸ‹ (End Date)
                    </label>
                    <input
                        type="date"
                        id="endDate"
                        value="2026-01-21"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                    />
                    <p class="text-sm text-gray-500 mt-1" id="endDatePreview">Will display as: 21-01-2026</p>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        á…áŸ†á“á½á“á‚á˜áŸ’ášáŸ„á„ (Number of Projects)
                    </label>
                    <input
                        type="number"
                        id="projectCount"
                        value="25"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        placeholder="25"
                        min="0"
                    />
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        á…á˜áŸ’á„á¶á™áŸášá»á” (Total Distance in Meters)
                    </label>
                    <input
                        type="number"
                        id="distanceMeters"
                        value="5400"
                        class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                        placeholder="5400"
                        min="0"
                        step="1"
                    />
                    <p class="text-sm text-gray-500 mt-1" id="distancePreview">
                        = 5.4km (5400 meters)
                    </p>
                </div>
            </div>

            <div class="bg-indigo-50 border-l-4 border-indigo-500 p-6 rounded">
                <h2 class="text-sm font-semibold text-indigo-800 mb-2">Generated Message:</h2>
                <p class="text-lg text-gray-800 font-medium whitespace-pre-line" id="generatedMessage"></p>
            </div>

            <button
                onclick="copyToClipboard()"
                class="mt-4 w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors"
            >
                Copy to Clipboard
            </button>

            <div class="mt-4">
                <button
                    onclick="toggleTelegramSettings()"
                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center gap-2"
                >
                    <span>âš™ï¸</span>
                    <span id="toggleText">Show Telegram Settings</span>
                </button>

                <div id="telegramSettings" class="mt-4 p-4 bg-gray-50 rounded-md space-y-3 hidden">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">
                            Bot Token
                        </label>
                        <input
                            type="text"
                            id="botToken"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"
                            placeholder="123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
                        />
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">
                            Chat ID
                        </label>
                        <input
                            type="text"
                            id="chatId"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm"
                            placeholder="-1001234567890 or 123456789"
                        />
                    </div>
                    <p class="text-xs text-gray-500">
                        Get your bot token from @BotFather. Get chat ID from @userinfobot or group info.
                    </p>
                </div>

                <button
                    onclick="sendToTelegram()"
                    class="mt-3 w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors flex items-center justify-center gap-2"
                >
                    <span>ğŸ“±</span>
                    Send to Telegram
                </button>

                <div id="sendStatus" class="mt-2 p-3 rounded-md text-sm hidden"></div>
            </div>
        </div>
    </div>

    <script>
        // Format date from YYYY-MM-DD to DD-MM-YYYY
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const [year, month, day] = dateStr.split('-');
            return `${day}-${month}-${year}`;
        }

        // Convert meters to km
        function metersToKm(meters) {
            const num = parseFloat(meters);
            if (isNaN(num)) return '0km';
            return `${(num / 1000).toFixed(1)}km`;
        }

        // Generate the sentence
        function generateSentence() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const projectCount = document.getElementById('projectCount').value;
            const distanceMeters = document.getElementById('distanceMeters').value;

            const sentence = `á‘á·á“áŸ’á“á“áŸá™á‚á·áá…á¶á”áŸ‹á–á¸ááŸ’á„áŸƒá‘á¸ [${formatDate(startDate)}] áŠá›áŸ‹ááŸ’á„áŸƒá‘á¸ â€‹[${formatDate(endDate)}] á‚á˜áŸ’ášáŸ„á„á”á‰áŸ’á…á¼á›â€‹á‘áŸ…â€‹á€áŸ’á“á»á„â€‹á€á˜áŸ’á˜áœá·á’á¸ KIS á˜á¶á“â€‹á…áŸ†á“á½á“ [${projectCount}] á‚á˜áŸ’ášáŸ„á„ áŸáŸ’á˜á¾ [${metersToKm(distanceMeters)}]áŸ”
áŸá¼á˜á¢ášá‚á»á`;

            document.getElementById('generatedMessage').textContent = sentence;
            
            // Update previews
            document.getElementById('startDatePreview').textContent = `Will display as: ${formatDate(startDate)}`;
            document.getElementById('endDatePreview').textContent = `Will display as: ${formatDate(endDate)}`;
            document.getElementById('distancePreview').textContent = `= ${metersToKm(distanceMeters)} (${distanceMeters} meters)`;
            
            return sentence;
        }

        // Copy to clipboard
        function copyToClipboard() {
            const text = generateSentence();
            navigator.clipboard.writeText(text).then(() => {
                showStatus('âœ“ Copied to clipboard!', 'success');
            }).catch(() => {
                showStatus('Failed to copy', 'error');
            });
        }

        // Toggle telegram settings
        function toggleTelegramSettings() {
            const settings = document.getElementById('telegramSettings');
            const toggleText = document.getElementById('toggleText');
            
            if (settings.classList.contains('hidden')) {
                settings.classList.remove('hidden');
                toggleText.textContent = 'Hide Telegram Settings';
            } else {
                settings.classList.add('hidden');
                toggleText.textContent = 'Show Telegram Settings';
            }
        }

        // Send to Telegram
        async function sendToTelegram() {
            const botToken = document.getElementById('botToken').value;
            const chatId = document.getElementById('chatId').value;
            const message = generateSentence();

            if (!botToken || !chatId) {
                showStatus('Please set Bot Token and Chat ID first', 'error');
                if (document.getElementById('telegramSettings').classList.contains('hidden')) {
                    toggleTelegramSettings();
                }
                return;
            }

            showStatus('Sending...', 'info');

            try {
                const response = await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: chatId,
                        text: message,
                    }),
                });

                const data = await response.json();

                if (data.ok) {
                    showStatus('âœ“ Sent successfully!', 'success');
                    setTimeout(() => {
                        document.getElementById('sendStatus').classList.add('hidden');
                    }, 3000);
                } else {
                    showStatus(`Error: ${data.description || 'Failed to send'}`, 'error');
                }
            } catch (error) {
                showStatus(`Error: ${error.message}`, 'error');
            }
        }

        // Show status message
        function showStatus(message, type) {
            const statusEl = document.getElementById('sendStatus');
            statusEl.textContent = message;
            statusEl.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800', 'bg-blue-100', 'text-blue-800');
            
            if (type === 'success') {
                statusEl.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                statusEl.classList.add('bg-red-100', 'text-red-800');
            } else {
                statusEl.classList.add('bg-blue-100', 'text-blue-800');
            }
        }

        // Add event listeners
        document.getElementById('startDate').addEventListener('input', generateSentence);
        document.getElementById('endDate').addEventListener('input', generateSentence);
        document.getElementById('projectCount').addEventListener('input', generateSentence);
        document.getElementById('distanceMeters').addEventListener('input', generateSentence);

        // Generate initial sentence
        generateSentence();
    </script>
</body>
</html>